<!DOCTYPE html>

<html class=""><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><link href="cid:css-f706d402-6aec-4150-95a3-0821caac69ff@mhtml.blink" rel="stylesheet" type="text/css"/><link href="cid:css-bf2f2060-7f36-44f0-aa94-311be1f3c0b6@mhtml.blink" rel="stylesheet" type="text/css"/><link href="cid:css-6eafe14d-09ff-484a-9390-87644ca64c9f@mhtml.blink" rel="stylesheet" type="text/css"/><link href="cid:css-d74d78e7-f867-4bb1-bb72-bb09d767597a@mhtml.blink" rel="stylesheet" type="text/css"/><link href="cid:css-d9183622-1f35-4ffc-8ef2-e20128289e89@mhtml.blink" rel="stylesheet" type="text/css"/><link href="cid:css-74600d07-489a-465d-acbf-e704de2c795e@mhtml.blink" rel="stylesheet" type="text/css"/><link href="cid:css-42e938f0-3414-4b92-927f-f3d1a8e3800b@mhtml.blink" rel="stylesheet" type="text/css"/><link href="cid:css-159c15a1-e427-4a98-b853-64b4a509fbe1@mhtml.blink" rel="stylesheet" type="text/css"/><link href="cid:css-c1dcab6e-c3e8-4073-a50b-6fc5a1ee862d@mhtml.blink" rel="stylesheet" type="text/css"/><link href="cid:css-e58add38-2877-4440-bf2f-2a927845803e@mhtml.blink" rel="stylesheet" type="text/css"/>
<meta content="true" name="wechat-enable-text-zoom-em"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="light dark" name="color-scheme"/>
<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover" name="viewport"/>
<link href="https://res.wx.qq.com/a/wx_fed/assets/res/NTI4MWU5.ico" rel="shortcut icon" reportloaderror="" type="image/x-icon"/>
<link color="#4C4C4C" href="https://res.wx.qq.com/a/wx_fed/assets/res/MjliNWVm.svg" rel="mask-icon" reportloaderror=""/>
<link href="https://res.wx.qq.com/a/wx_fed/assets/res/OTE0YTAw.png" rel="apple-touch-icon-precomposed" reportloaderror=""/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="black" name="apple-mobile-web-app-status-bar-style"/>
<meta content="telephone=no" name="format-detection"/>
<meta content="origin-when-cross-origin" name="referrer"/>
<meta content="strict-origin-when-cross-origin" name="referrer"/>
<meta content="" name="description"/>
<meta content="BlackWatch" name="author"/>
<meta content="浅析JWT安全问题" property="og:title"/>
<meta content="http://mp.weixin.qq.com/s?__biz=MjM5MTYxNjQxOA==&amp;mid=2652889588&amp;idx=1&amp;sn=1afe95b49f1645407e4a218cf187fcba&amp;chksm=bd599d398a2e142f7af13f39c79a7f08144649749a5ee959e851b4bac037cef3b0d69121a0f3#rd" property="og:url"/>
<meta content="https://mmbiz.qpic.cn/mmbiz_jpg/3RhuVysG9LeibWpqADou9GDJOCsbe6d33thrjibqAsBMSTiaqI4W7tIxCBlkuXKoDW4x8Eg0ekcdKfIhzKsVOW6WA/0?wx_fmt=jpeg" property="og:image"/>
<meta content="" property="og:description"/>
<meta content="微信公众平台" property="og:site_name"/>
<meta content="article" property="og:type"/>
<meta content="BlackWatch" property="og:article:author"/>
<meta content="summary" property="twitter:card"/>
<meta content="https://mmbiz.qpic.cn/mmbiz_jpg/3RhuVysG9LeibWpqADou9GDJOCsbe6d33thrjibqAsBMSTiaqI4W7tIxCBlkuXKoDW4x8Eg0ekcdKfIhzKsVOW6WA/0?wx_fmt=jpeg" property="twitter:image"/>
<meta content="浅析JWT安全问题" property="twitter:title"/>
<meta content="BlackWatch" property="twitter:creator"/>
<meta content="微信公众平台" property="twitter:site"/>
<meta content="" property="twitter:description"/>
<title>浅析JWT安全问题</title>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/modulepreload-polyfill.ls8mkuxc4abee2a4.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/vue.runtime.esm.ls8mkuxc7cbeb265.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/_plugin-vue2_normalizer.ls8mkuxcfc2fb13f.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/event.ls8mkuxc82acd1b6.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/class.ls8mkuxc32861355.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/core.ls8mkuxc1ee63245.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/ajax.ls8mkuxc68eaaaa0.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/comm_report.ls8mkuxc239cb70f.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/storage.ls8mkuxc595374ad.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/comm_utils.ls8mkuxccc4e5a35.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/i18n.ls8mkuxc2e3f9c7c.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/page_utils.ls8mkuxc371daeae.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/page_cls_ctrl.ls8mkuxcbbe1df6f.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/wxgspeedsdk.ls8mkuxc180611fe.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/pay_report_utils.ls8mkuxc487b1277.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/appmsgext.ls8mkuxcc97e34a9.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/page_utils.ls8mkuxc7a1a046b.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/tmpl.ls8mkuxcb6faf396.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/topbar.ls8mkuxcd1f1c8b4.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/base64.ls8mkuxc18dbe4cd.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/index.ls8mkuxcd721ca48.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/advance.ls8mkuxcc429f8b9.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/body_first_observer.ls8mkuxc55cb6e3e.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/get_page_read_pos.ls8mkuxc57f9bfd3.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/set_article_read.ls8mkuxca0b2368c.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/stream_hide_useless.ls8mkuxce7a65152.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/render_utils.ls8mkuxc853756c0.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/underline_action.ls8mkuxc1cc7f123.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/wxwork_hidden.ls8mkuxc1ba2f8e1.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/ext_loading.ls8mkuxc8232d862.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/outer_link.ls8mkuxc6414be2e.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/dom.ls8mkuxcc37e669f.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/review_image.ls8mkuxc04f6b7b1.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/index.ls8mkuxc146098fc.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/moment.ls8mkuxc07db360f.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/img_onload_handler.ls8mkuxcce139fc0.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/like_and_share.ls8mkuxc6218e81d.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/voice_component.ls8mkuxc557ce228.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/interaction.ls8mkuxc0924f6ea.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/background_color.ls8mkuxcef117ae1.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/article_bottom_bar.ls8mkuxc29bb6df3.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/pre_loading.ls8mkuxc93dbd6e0.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/get_word_cnt.ls8mkuxc1a70c97b.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/bind_element.ls8mkuxcabfacaa1.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/set_custom_ele.ls8mkuxc3c4ac1e9.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/modal.ls8mkuxcd01ea73f.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/intersection-observer.ls8mkuxce16580c9.js" rel="modulepreload" reportloaderror=""/>
<link crossorigin="" href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/range_close.ls8mkuxc5bc42e49.js" rel="modulepreload" reportloaderror=""/>
<link href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/index.ls8mkuxcdf633ac1.css" rel="stylesheet" reportloaderror=""/>
<link href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/wxwork_hidden.ls8mkuxcbb3823ad.css" rel="stylesheet" reportloaderror=""/>
<link href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/like_and_share.ls8mkuxce3b0c442.css" rel="stylesheet" reportloaderror=""/>
<link href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/interaction.ls8mkuxcb3298e9e.css" rel="stylesheet" reportloaderror=""/>
<link href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/article_bottom_bar.ls8mkuxc88987ef0.css" rel="stylesheet" reportloaderror=""/>
<link href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/qqmail_tpl_vite_entry.ls8mkuxcfd9a827e.css" rel="stylesheet" reportloaderror=""/>
<link href="https://res.wx.qq.com/mmbizappmsg/zh_CN/htmledition/js/assets/tencent_portfolio_light.ls8mkuxc02b9ee15.css" rel="stylesheet" reportloaderror=""/>
<link href="https://res.wx.qq.com/t/wx_fed/weui-source/res/2.6.4/weui.min.css" rel="stylesheet"/></head>
<body class="zh_CN wx_wap_page wx_wap_desktop_fontsize_2 mm_appmsg comment_feature discuss_tab appmsg_skin_default appmsg_style_default pages_skin_pc not_in_mm" id="activity-detail">
<link href="https://res.wx.qq.com/" rel="dns-prefetch" reportloaderror=""/>
<link href="https://mmbiz.qpic.cn/" rel="dns-prefetch" reportloaderror=""/>
<link href="https://mpcdn.qpic.cn/" rel="dns-prefetch" reportloaderror=""/>
<link href="https://mpcdn.weixin.qq.com/" rel="dns-prefetch" reportloaderror=""/>
<link href="https://file.daihuo.qq.com/" rel="dns-prefetch" reportloaderror=""/>
<link href="https://wxa.wxs.qq.com/" rel="dns-prefetch" reportloaderror=""/>
<link href="https://res.wx.qq.com/a/wx_fed/assets/res/NTI4MWU5.ico" rel="shortcut icon" reportloaderror="" type="image/x-icon"/>
<link color="#4C4C4C" href="https://res.wx.qq.com/a/wx_fed/assets/res/MjliNWVm.svg" rel="mask-icon" reportloaderror=""/>
<link href="https://res.wx.qq.com/a/wx_fed/assets/res/OTE0YTAw.png" rel="apple-touch-icon-precomposed" reportloaderror=""/>
<div class="rich_media" id="js_article" style="position:relative;">
<div class="top_banner" id="js_top_ad_area"></div>
<div class="rich_media_inner" id="js_base_container">
<div class="rich_media_area_primary" id="page-content">
<div class="rich_media_area_primary_inner">
<div class="rich_media_wrp" id="img-content">
<h1 class="rich_media_title" id="activity-name">
            
浅析JWT安全问题
          </h1>
<div class="rich_media_meta_list" id="meta_content">
<span class="wx_tap_link js_wx_tap_highlight rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea" id="copyright_logo">原创</span>
<span class="rich_media_meta rich_media_meta_text">
                                      BlackWatch
                                  </span>
<span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
<a class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">
                合天网安实验室              </a>
<div aria-hidden="true" class="profile_container" id="js_profile_qrcode" style="display:none;">
<div class="profile_inner">
<strong class="profile_nickname">合天网安实验室</strong>
<img alt="" class="profile_avatar" id="js_profile_qrcode_img" src="https://mp.weixin.qq.com/s?__biz=MjM5MTYxNjQxOA==&amp;mid=2652889588&amp;idx=1&amp;sn=1afe95b49f1645407e4a218cf187fcba&amp;chksm=bd599d398a2e142f7af13f39c79a7f08144649749a5ee959e851b4bac037cef3b0d69121a0f3"/>
<p class="profile_meta">
<label class="profile_meta_label">微信号</label>
<span class="profile_meta_value">hee_tian</span>
</p>
<p class="profile_meta">
<label class="profile_meta_label">功能介绍</label>
<span class="profile_meta_value">为广大信息安全爱好者提供有价值的文章推送服务！</span>
</p>
</div>
<span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
<i class="profile_arrow arrow_out"></i>
<i class="profile_arrow arrow_in"></i>
</span>
</div>
</span>
<span id="meta_content_hide_info">
<em class="rich_media_meta rich_media_meta_text" id="publish_time">2022-08-08 09:30</em>
<em aria-labelledby="js_a11y_op_ip_wording js_ip_wording" class="rich_media_meta rich_media_meta_text" id="js_ip_wording_wrp" role="option" style="display: inline-block;"><span aria-hidden="true" id="js_a11y_op_ip_wording"></span><span aria-hidden="true" id="js_ip_wording">湖南</span></em>
</span>
</div>
<div class="rich_media_content js_underline_content" id="js_content" style="visibility: visible;"><section style="margin-top: 9pt; margin-bottom: 9pt; text-align: justify; margin-left: 0pt; text-indent: 0pt; font-size: 12pt; font-family: Cambria; font-weight: normal; line-height: 1.75em; visibility: visible;"><span style="font-family: Cambria; font-size: 15px; letter-spacing: 2px; visibility: visible;">重生之我是JWT</span></section><section style="margin-top: 9pt; margin-bottom: 9pt; text-align: justify; margin-left: 0pt; text-indent: 0pt; font-size: 12pt; font-family: Cambria; font-weight: normal; line-height: 1.75em; visibility: visible;"><span style="font-family: Cambria; font-size: 15px; letter-spacing: 2px; visibility: visible;"><br style="visibility: visible;"/></span></section><section style="margin-top: 9pt; margin-bottom: 9pt; text-align: justify; margin-left: 0pt; text-indent: 0pt; font-size: 12pt; font-family: Cambria; font-weight: normal; line-height: 1.75em; visibility: visible;"><span style="font-family: Cambria; font-size: 15px; letter-spacing: 2px; visibility: visible;">前不久研究websocket时发现port-swigger出了新的靶场，一看，发现是关于jwt安全的，刚好来总结回忆一下</span></section><section style="margin-top: 24pt; margin-bottom: 0pt; text-align: justify; margin-left: 0pt; text-indent: 0pt; break-after: avoid; font-size: 16pt; font-family: Calibri; color: rgb(79, 129, 189); font-weight: bold; line-height: 1.75em; visibility: visible;"><span style="font-family: Calibri; font-size: 15px; letter-spacing: 2px; visibility: visible;">JWT简介</span></section><section style="margin-top: 9pt; margin-bottom: 9pt; text-align: justify; margin-left: 0pt; text-indent: 0pt; font-size: 12pt; font-family: Cambria; font-weight: normal; line-height: 1.75em; visibility: visible;"><span style="font-family: Cambria; font-size: 15px; letter-spacing: 2px; visibility: visible;">Json web token (JWT)，是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（RFC 7519）</span></section><section style="margin-top: 0pt; margin-bottom: 10pt; text-align: justify; font-size: 12pt; font-family: Cambria; font-weight: normal; margin-left: 36pt; text-indent: -24pt; line-height: 1.75em; visibility: visible;"><span style="font-size: 15px; font-family: Cambria; letter-spacing: 2px; visibility: visible;">•RFC 7519:</span><span style="font-family: Cambria; text-decoration: none; font-size: 15px; letter-spacing: 2px; visibility: visible;">https://datatracker.ietf.org/doc/html/rfc7519</span></section><section style="margin-top: 9pt; margin-bottom: 9pt; text-align: justify; margin-left: 0pt; text-indent: 0pt; font-size: 12pt; font-family: Cambria; font-weight: normal; line-height: 1.75em; visibility: visible;"><span style="font-family: Cambria; font-size: 15px; letter-spacing: 2px; visibility: visible;">他定义了一种紧凑且自包含的方式，用于在各方之间安全地传输信息作为 JSON 对象，特别适用于分布式站点的单点登录（SSO）场景</span></section><section style="margin-top: 10pt; margin-bottom: 0pt; text-align: justify; margin-left: 0pt; text-indent: 0pt; break-after: avoid; font-size: 14pt; font-family: Calibri; color: rgb(79, 129, 189); font-weight: bold; line-height: 1.75em; visibility: visible;"><span style="font-family: Calibri; font-size: 15px; letter-spacing: 2px; visibility: visible;">JWT与cookie/session的异同</span></section><section style="margin-top: 0pt; margin-bottom: 10pt; text-align: justify; font-size: 12pt; font-family: Cambria; font-weight: normal; margin-left: 36pt; text-indent: -24pt; line-height: 1.75em; visibility: visible;"><span style="font-family: Cambria; font-size: 15px; letter-spacing: 2px; visibility: visible;">•JWT与cookie/session一样，都是作用于前后端认证</span></section><section style="margin-top: 0pt; margin-bottom: 10pt; text-align: justify; font-size: 12pt; font-family: Cambria; font-weight: normal; margin-left: 36pt; text-indent: -24pt; line-height: 1.75em; visibility: visible;"><span style="font-family: Cambria; font-size: 15px; letter-spacing: 2px; visibility: visible;">•cookie/session：后端有个session，前端有个cookie，这样的基于session的认证会要求服务端不断存储用户登录信息，而随着不同客户端用户的增加，独立的服务器会逐渐无法承载更多的用户，导致其服务器的压力十分巨大，且cookie一旦被窃取还可能造成CSRF攻击</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: justify;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•JWT：当我们把前后端分离开来，后端不再有session，当不再需要保存session文件，这就降低了服务端的负担，而我们就可以利用JWT这么一个基于token的鉴权认证，而基于token认证机制的应用就不需要去考虑用户在哪个服务器登录，客户端也可以将通过服务器认证后的json对象存储起来，下次访问时连同请求内容一同发送即可</span></section><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: justify;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 14pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: Calibri;font-size: 15px;letter-spacing: 2px;">JWT格式</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: justify;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-size: 15px;letter-spacing: 2px;"><span style="font-family: Cambria;">JWT由</span><span style="font-family: Consolas;">Header、Payload、Signature</span><span style="font-family: Cambria;">组成</span></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: justify;margin-left: 0pt;text-indent: 0pt;word-break: break-all;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Consolas;font-size: 15px;letter-spacing: 2px;">Header.Payload.Signature</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;margin-left: 0.0pt;text-indent: 0.0pt;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;"><span style="font-family: Cambria;"><shape filled="f" style="text-indent:0;left:0;width:420.0pt;height:257.2649pt;" type="#_x0000_t75"><imagedata title="rId22"></imagedata></shape><img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33w3oQN6HDjlHfhPLfJz7f3Np0THK9iaI9LYF24sEr3QbibPnujNbAEW0A/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;margin-left: 0.0pt;text-indent: 0.0pt;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;"><span style="font-family: Cambria;"><br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•Header</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;word-break: break-all;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-size: 15px;letter-spacing: 2px;"><span style="font-family: Cambria;"> </span><span style="font-family: Consolas;">{"alg":"加密算法","typ":"JWT"}</span></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•Payload</span></section><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="javascript"><code><span class="code-snippet_outer"> iss: The issuer of the token</span></code><code><span class="code-snippet_outer">sub: The subject of the token</span></code><code><span class="code-snippet_outer">aud: The audience of the token</span></code><code><span class="code-snippet_outer">exp: JWT expiration time defined in Unix time</span></code><code><span class="code-snippet_outer">nbf: "Not before" time that identifies the time before which the JWT must not be accepted for processing</span></code><code><span class="code-snippet_outer">iat: "Issued at" time, in Unix time, at which the token was issued</span></code><code><span class="code-snippet_outer">jti: JWT ID claim provides a unique identifier for the JWT</span></code><code><span class="code-snippet_outer">//可以自定义其它字段</span></code></pre></section><p style="mso-style-name: 'Source Code';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;word-break: break-all;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><br/></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•Signature</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;word-break: break-all;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-size: 15px;letter-spacing: 2px;"><span style="font-family: Cambria;"> </span><span style="font-family: Consolas;">Signature = HMACSHA256(base64UrlEncode(header) + "." + base64UrlEncode(payload),"secret")</span></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> secret保存在后端，就是来解析确定验证的key</span></section><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 14pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: Calibri;font-size: 15px;letter-spacing: 2px;">JWT&amp;JWS&amp;JWE</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•JWS，即JSON Web Signature，只是 JWT 的一种实现</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•JWE，即JSON Web Encryption，也只是 JWT 的一种实现</span></section><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 14pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: 宋体;font-size: 15px;letter-spacing: 2px;">潜在漏洞</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•签名未校验</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•算法被篡改</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•敏感信息泄露</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•加密算法不安全</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•伪造密钥(CVE-2018-0114)</span></section><section style="margin-top: 24pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 16pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: Calibri;font-size: 15px;letter-spacing: 2px;">JWT安全问题</span></section><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 14pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: 宋体;font-size: 15px;letter-spacing: 2px;">未对签名进行验证</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">我们前面说过，JWT存在一个Signature 签名，如若没对签名进行认证，就可能存在越权情况</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•靶场</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> Lab: JWT authentication bypass via unverified signature</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•解法</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;word-break: break-all;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-size: 15px;letter-spacing: 2px;"><span style="font-family: Cambria;"> </span><span style="font-family: Consolas;">To solve the lab, modify your session token to gain access to the admin panel at /admin, then delete the user carlos.</span></span></section><p style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 我们需要把carlos删掉，而这就需要登录管理员账号，但是又没有给管理员的账号，只有一个普通用户，那我们就要想办法提升权限</span></p><p style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 先抓包</span></p><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33Z9A1nCA9uWN1Ry5cBZoibxIWiagLn94TR0xGVZsuiarUmsKqycevbo1ew/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 观察确定为JWT，将payload处字符base64解码得</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;break-after: avoid;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33WFyfPCndecC00PQT8oUg7Y7wYUGqH2zuO2svo5qfiapQTVFwXjMEPyg/640"/></span></section><section style="margin-top: 0pt;margin-bottom: 6pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> <br/></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 把sub的wiener修改为administrator，重新传参</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33ibruVjBmmZWzCL2wYrCzkwcaX1RBRPIYNux2taAMzTibvZhfiaDOZWNHQ/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family:Cambria;"> </span><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">成功越权，然后就是删除用户即可</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;break-after: avoid;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33HS5f0OibicHdKG76iaC2WwiaoJHPcK4rMe5jgDFdBQ17QkMibBC0RC8SM8Q/640"/></span></section><section style="margin-top: 0pt;margin-bottom: 6pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> <br/></span></section><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 14pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: 宋体;font-size: 15px;letter-spacing: 2px;">未对加密算法进行强验证</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">回顾一下Header的构成</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;margin-left: 0pt;text-indent: 0pt;word-break: break-all;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Consolas;font-size: 15px;letter-spacing: 2px;">{"alg":"加密算法","typ":"JWT"}</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">这里alg可以说明加密算法，但如果对该设置不进行强认证也会造成越权问题</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">我们可以把加密算法设成none来进行验证绕过</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•靶场</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> Lab: JWT authentication bypass via flawed signature verification</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•解法</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 先和上题一致，将sub内容修改为administrator，然后发现还是没能成为管理员，接着修改header的alg为none，把后续的Signature删除，因为Signature是通过alg算法生成的，既然alg都为none了，那Signature也应该为空了</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;break-after: avoid;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33ewgXp4GxTyoKBPib6icauNWNpjZaOiagskBgMibEKjxrTORFhUqYhria5yA/640"/></span></section><section style="margin-top: 0pt;margin-bottom: 6pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> <br/></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 成功变成管理员</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33maw01LP1UNI1VGhl7E84mR8XIJpxGOFeIIORia2qK4KWuibibUafSN30w/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family:Cambria;"> </span><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">然后就是正常删除用户就行</span></section><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 14pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: 宋体;font-size: 15px;letter-spacing: 2px;">绕过弱签名密钥进行越权</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;margin-left: 0pt;text-indent: 0pt;word-break: break-all;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Consolas;font-size: 15px;letter-spacing: 2px;">Signature = HMACSHA256(base64UrlEncode(header) + "." + base64UrlEncode(payload),"secret")</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">我们知道，签名存在一个secret密钥，这个一般都会保存在后端，别人无法查看，但是类同于弱口令，一旦这个密钥不复杂就有可能被爆破，gayhub上也有很多爆破的字典</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•靶场</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> Lab: JWT authentication bypass via weak signing key</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•解法</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 还是一样先抓包得到JWT</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 然后用到hashcat来进行爆破，kali自带</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;word-break: break-all;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-size: 15px;letter-spacing: 2px;"><span style="font-family: Cambria;"> </span><span style="font-family: Consolas;">hashcat -a 0 -m 16500</span></span><span style="font-family: Consolas;font-size: 15px;letter-spacing: 2px;"><your-jwt>/path/to/jwt.secrets.list</your-jwt><your-jwt></your-jwt></span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d333uGW4PwryrpnbMAs4LpIOSktH2iaD2fJdOica7rANRpVq0Jf7xcLAJJw/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="letter-spacing: 2px;font-size: 15px;"><span style="font-family: Cambria;"> 爆破得到</span><span style="font-family: Consolas;">secret</span><span style="font-family: Cambria;">为secret1</span></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;letter-spacing: 2px;font-size: 15px;"> 然后前往jwt.io生成我们需要的的jwt，把sub和secret进行修改</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33ibDEU7EgcVRYqrFjLO9ianAdFreVDWJgqwvbLVafrPxqbmlOfhEicibIfQ/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family: Cambria;letter-spacing: 2px;font-size: 15px;"> <br/></span></p><p style="mso-style-parent: '';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family: Cambria;letter-spacing: 2px;font-size: 15px;"> 重新传包，成功</span></p><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33icnCttk13wLaLUJnXFJgFqxBibS3zds22K4tdZMWC0Gf9BZWh6iaKVtdA/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 14pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: Calibri;font-size: 15px;letter-spacing: 2px;">JWT标头注入</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">与很多注入一样，JWT标头注入也可大致分为两种情况，一是与数据库连接，搭配sql注入使用，一是不与数据库连接，单独进行越权操作</span></section><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 12pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: 宋体;font-size: 15px;letter-spacing: 2px;">通过jwk参数注入自签名的JWT</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">还记得我们说过的JWS吗</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;margin-left: 0pt;text-indent: 0pt;word-break: break-all;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Consolas;font-size: 15px;letter-spacing: 2px;">JWS，即JSON Web Signature，只是 JWT 的一种实现</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">我们就可以通过JWK注入JWT，形成JWS</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•那什么是JWK呢</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> JWK 英文全称为 JSON Web Key，是一个JSON对象，表示一个加密的密钥，他不同于alg属性，JWK是可选的，以下就是一个示例</span></section><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="json"><code><span class="code-snippet_outer"> {</span></code><code><span class="code-snippet_outer">    "kid": "ed2Nf8sb-sD6ng0-scs5390g-fFD8sfxG",</span></code><code><span class="code-snippet_outer">    "typ": "JWT",</span></code><code><span class="code-snippet_outer">    "alg": "RS256",</span></code><code><span class="code-snippet_outer">    "jwk": {</span></code><code><span class="code-snippet_outer">        "kty": "RSA",</span></code><code><span class="code-snippet_outer">        "e": "AQAB",</span></code><code><span class="code-snippet_outer">        "kid": "ed2Nf8sb-sD6ng0-scs5390g-fFD8sfxG",</span></code><code><span class="code-snippet_outer">        "n": "yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9m"</span></code><code><span class="code-snippet_outer">    }</span></code><code><span class="code-snippet_outer">}</span></code></pre></section><p style="mso-style-name: 'Source Code';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;word-break: break-all;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><br/></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•在理想情况下，服务器应该是只使用公钥白名单来验证JWT签名的，但对于一些相关配置错误的服务器会用JWK参数中嵌入的任何密钥进行验证，攻击者就可以利用这一行为，用自己的RSA私钥对修改过的JWT进行签名，然后在JWK头部中嵌入对应的公钥进行越权操作</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•靶场</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> Lab: JWT authentication bypass via jwk header injection</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•解法</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 需要先安装一个插件，方便后续的操作</span></section><p style="mso-style-parent: '';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 72.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;">–JWT Editor</span></p><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 72.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33xcaPS5UjzE6kHqVkfh4dWp9KcjPDehZvemdDGjKkGDT8liamDXb2n3Q/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 72.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 然后正常抓包，将sub内容修改为administrator</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 然后切换到JWT Editor Keys选项new一个RSA Key</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33LpoIWWVtx7nuKc93Y93BEUTib7iaruMhcs1hVs15mv3O6M5WZKdb3CHA/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 我是已经生成的了，然后保存后回到Repeater选择Embedded JWK攻击</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;break-after: avoid;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33AMyBa4UPzuey97gNuT7JjbRjbEP1SSibHIhJ13kGzfD8pB6x3wJoU7g/640"/></span></section><section style="margin-top: 0pt;margin-bottom: 6pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> <br/></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 成功越权</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33rwQUCKUMhYrricjrGc3ndTwbgj5gib3U6OHHSibvKWFM2I2oUdtG2ibibXQ/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 12pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: 宋体;font-size: 15px;letter-spacing: 2px;">通过jku参数注入自签名的JWT</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">有些服务器并不会直接使用JWK头部参数来嵌入公钥，而是使用JKU（JWK Set URL）来引用一个包含了密钥的JWK Set，我们就可以借此来构造一个密钥从而实现越权操作</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•靶场</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> Lab: JWT authentication bypass via jku header injection</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•解法</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 先还是正常抓包修改sub内容，然后去到JWT Editor Keys生成一个RSA密钥，或者用上一道题目的也行，然后复制公钥</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33aJcY4WjSGaCklmTUWBaH49FxgYfSvuh1jhpDhPEJANzjT37o9PklVA/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><p style="mso-style-parent: '';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 然后加上key头</span></p><section class="code-snippet__fix code-snippet__js"><ul class="code-snippet__line-index code-snippet__js"><li></li><li></li><li></li><li></li><li></li></ul><pre class="code-snippet__js" data-lang="json"><code><span class="code-snippet_outer"> {</span></code><code><span class="code-snippet_outer">    "keys": [</span></code><code><span class="code-snippet_outer"><br/></span></code><code><span class="code-snippet_outer">    ]</span></code><code><span class="code-snippet_outer">}</span></code></pre></section><p style="mso-style-name: 'Source Code';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;word-break: break-all;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><br/></p><p style="mso-style-parent: '';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> </span><span style="letter-spacing: 2px;font-family: Cambria;font-size: 15px;">保存到exploit的body中</span></p><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33KndPgkYaiadotq6Struyvia56vQt8be7MO9RVvpWMBk7OVjjUonQb23Q/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: justify;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 然后将kid修改成自己生成的JWK中的kid值，将jku的值改为exploit，使其导入</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33YfyUS18d0RNUwg6YDxpnCxngB9goqTM6NyX5qNG00xhaTmHC02unWg/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><p style="mso-style-parent: '';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="letter-spacing: 2px;font-size: 15px;"><span style="font-family: Cambria;"> 然后回到点击下面的sign，选择</span><span style="font-family: Cambria;font-weight: bold;">Don’t modify header</span><span style="font-family: Cambria;"> 模式，Sign 即可</span></span></p><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family: Cambria;font-size: 15px;"> </span><span style="font-family:Cambria;"><img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33p9L02cMeIqibAaogBeQ3K5bfEveVFrVY8jI4sYNk0Koricfrtfia7lqiag/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><p style="mso-style-parent: '';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family: Cambria;letter-spacing: 2px;font-size: 15px;"> 成功越权</span></p><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33YWlxQvd0bQXvL0hT1GvJZL0iaEo2FXq9HN5icoWGCfQWV4n5drMr1u3A/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 12pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: 宋体;font-size: 15px;letter-spacing: 2px;">通过kid参数注入自签名的JWT</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">服务器可能会使用多个加密密钥来为不同类型的数据进行签名，出于这个原因，在JWT头部有时会包含一个kid参数，以避免服务器验证签名时出现错误，而在JWT规范中并没有对这个kid定义具体的结构，他仅仅是开发人员任意选择的一个字符串，可能只是一个指向数据库中的一个特定条目，甚至只是一个文件的名称也有可能</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•而安全问题就出现在这里，一旦这个参数受到目录遍历影响，就易被攻击者使用服务器任意文件的文件名作为验证密钥形成攻击链</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•靶场</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> Lab: JWT authentication bypass via kid header path traversal</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•解法</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-size: 15px;letter-spacing: 2px;"><span style="font-family: Cambria;"> 先生成一个</span><span style="font-family: Consolas;">Symmetric Key</span><span style="font-family: Cambria;">，也就是对称密钥，并将 k 的值修改为 </span><span style="font-family: Consolas;">AA==</span><span style="font-family: Cambria;">即为null</span></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;break-after: avoid;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> </span><span style="font-family:Cambria;"><img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33ev6yibZIFaFXPqF1yt1XkMgoHoibDvnAicmW17Xq57qvTrSG6ajQaAsLQ/640"/></span></section><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 然后抓包修改kid值和sub进行目录遍历</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 72pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">–/dev/null是linux中的“黑洞”，代表空设备文件</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33oTRa1MTbK56oMnAibkiaTLAoX3kl6HhViaicGcDYE4ueJWYviawgr2KXbMg/640"/></span></p><section style="margin-top: 0pt;margin-bottom: 6pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> <br/></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-size: 15px;letter-spacing: 2px;"><span style="font-family: Cambria;"> </span><span style="font-family: Cambria;font-weight: bold;">/dev/null文件名与AA==一致都为null</span><span style="font-family: Cambria;">，对称密钥，应该可以成功绕过</span></span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 然后回到repeater点击sign选择OCT8 的密钥攻击</span></section><p style="mso-style-name: 'Captioned Figure';mso-style-parent: 'Figure';margin-top: 0.0pt;margin-bottom: 10.0pt;text-align: left;line-height: normal;page-break-after: avoid;font-size: 12.0pt;font-family: Cambria;font-weight: normal;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LeibWpqADou9GDJOCsbe6d33q1TIJY4bGy5icwhf6KkVHaTmPmQLrBboGbldiaBmPuEmF9IEDf0OicEiaw/640"/></span></p><p style="mso-style-name: 'Image Caption';mso-style-parent: 'Caption';margin-top: 0.0pt;margin-bottom: 6.0pt;text-align: left;line-height: normal;font-size: 12.0pt;font-family: Cambria;font-weight: normal;font-style: italic;margin-left: 36.0pt;text-indent: -24.0pt;"><span style="font-family:Cambria;"> <br/></span></p><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;"> 成功越权</span></section><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 12pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: 宋体;font-size: 15px;letter-spacing: 2px;">其他有趣的JWT头部参数</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•cty（内容类型）如果已经找到了绕过签名验证的方法，可以尝试注入cty参数，将内容类型改为text/xml或application/x-java-serialized-object，这有可能为XXE和反序列化攻击提供新的向量。</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•x5c（X.509证书链）类似于上面讨论的jwk头部注入攻击，由于此标头参数可用于注入自签名证书，且由于 X.509 格式及其扩展的复杂性，引入这些证书时也有可能引入漏洞，可见CVE-2017-2800 和 CVE-2018-2633</span></section><section style="margin-top: 10pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 14pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: Calibri;font-size: 15px;letter-spacing: 2px;">JWT算法混淆</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">即使服务器的密码是攻击者无法破解的复杂密码，但是由于JWT库的一些原生安全问题，攻击者可能会以开发者想不到的算法来伪造有效的JWT</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">portswigges里也有相关靶场，目前尚未完全理解，先挖个坑，后续补上</span></section><section style="margin-top: 24pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 16pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: Calibri;font-size: 15px;letter-spacing: 2px;">JWT攻击的防御</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">我们可以看到，JWT攻击千奇百怪，但是万变不离其宗，主要的潜在漏洞为</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•签名未校验</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•算法被篡改</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•敏感信息泄露</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•加密算法不安全</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•伪造密钥</span></section><section style="margin-top: 9pt;margin-bottom: 9pt;text-align: left;margin-left: 0pt;text-indent: 0pt;font-size: 12pt;font-family: Cambria;font-weight: normal;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">我们也可围绕这些进行JWT攻击进行防御</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•使用最新的 JWT 库，虽然最新版本的稳定性有待商榷，但是安全性都是较高的</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•对 jku 标头进行严格的白名单设置</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•确保 kid 标头不容易受到通过 header 参数进行目录遍历或 SQL 注入的攻击</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•始终为颁发的任何令牌设置一个到期日</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•尽可能避免通过URL参数发送令牌</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•提供aud声明（或类似内容），以指定令牌的预期接收者，防止其应用在不同网站</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•让颁发服务器能够撤销令牌</span></section><section style="margin-top: 24pt;margin-bottom: 0pt;text-align: left;margin-left: 0pt;text-indent: 0pt;break-after: avoid;font-size: 16pt;font-family: Calibri;color: rgb(79, 129, 189);font-weight: bold;line-height: 1.75em;"><span style="font-family: 宋体;font-size: 15px;letter-spacing: 2px;">参考链接</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•</span><span style="font-family: Cambria;text-decoration: none;font-size: 15px;letter-spacing: 2px;">https://drun1baby.github.io/2022/06/23/PortSwigger-JWT%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/#toc-heading-23</span></section><section style="margin-top: 0pt;margin-bottom: 10pt;text-align: left;font-size: 12pt;font-family: Cambria;font-weight: normal;margin-left: 36pt;text-indent: -24pt;line-height: 1.75em;"><span style="font-family: Cambria;font-size: 15px;letter-spacing: 2px;">•</span><span style="font-family: Cambria;text-decoration: none;font-size: 15px;letter-spacing: 2px;">https://xz.aliyun.com/t/9376#toc-9</span></section><section data-id="109226" data-tools="135编辑器" style='margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: 0.544px;orphans: 2;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;color: rgb(0, 0, 0);font-size: 16px;text-align: left;font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;background-color: rgb(255, 255, 255);'><section style="margin: 10px auto;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"><section style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;border-color: rgb(1, 120, 198);border-style: solid;border-width: 1px;border-radius: 10px;"><section style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;display: flex;align-items: center;background-color: rgb(221, 242, 255);border-top-right-radius: 10px;border-top-left-radius: 10px;"><section style="margin: 0px 0px 0px -1px;padding: 2px 15px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;color: rgb(255, 255, 255);letter-spacing: 1px;line-height: 1.75em;background-color: rgb(1, 120, 198);border-bottom-right-radius: 10px;border-top-left-radius: 10px;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 15px;font-family: arial, helvetica, sans-serif;"><strong data-brushtype="text" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">原创稿件征集</strong></span></section></section><section data-autoskip="1" style="margin: 0px;padding: 20px 15px 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;line-height: 1.75em;"><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;clear: both;min-height: 1em;color: rgb(35, 24, 21);font-size: 14px;letter-spacing: 1.5px;vertical-align: inherit;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;font-size: 15px;letter-spacing: 2px;">征集原创技术文章中，欢迎投递</span></p><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;clear: both;min-height: 1em;color: rgb(35, 24, 21);font-size: 14px;letter-spacing: 1.5px;vertical-align: inherit;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 15px;letter-spacing: 2px;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;">投稿邮箱：</span><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;font-family: arial, helvetica, sans-serif;">edu@antvsion.com</span></span></p><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;clear: both;min-height: 1em;color: rgb(35, 24, 21);font-size: 14px;letter-spacing: 1.5px;vertical-align: inherit;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 15px;letter-spacing: 2px;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;font-family: arial, helvetica, sans-serif;">文章类型：</span><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;color: rgb(255, 76, 65);">黑客极客技术、信息安全热点安全研究分析</span><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;color: rgb(51, 51, 51);">等</span><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;color: rgb(255, 76, 65);">安全相关</span></span></p><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;clear: both;min-height: 1em;color: rgb(35, 24, 21);font-size: 14px;letter-spacing: 1.5px;vertical-align: inherit;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 15px;letter-spacing: 2px;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;color: rgb(51, 51, 51);">通过审核并发布能收获</span><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;color: rgb(255, 76, 65);">200-800元</span><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;orphans: 4;white-space: pre-wrap;color: rgb(51, 51, 51);">不等的稿酬。</span></span></p><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;clear: both;min-height: 1em;color: rgb(35, 24, 21);font-size: 14px;letter-spacing: 1.5px;vertical-align: inherit;"><br style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;"/></p><p style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;clear: both;min-height: 1em;color: rgb(35, 24, 21);font-size: 14px;letter-spacing: 1.5px;vertical-align: inherit;"><a data-itemshowtype="0" data-linktype="2" hasload="1" href="http://mp.weixin.qq.com/s?__biz=MjM5MTYxNjQxOA==&amp;mid=2652885477&amp;idx=1&amp;sn=39e97a60d7b68d19569284654e74ffa1&amp;chksm=bd59ad288a2e243e4d89b7c456fbd44a93d241c881075b342af22431d93dca56e52076ed75ce&amp;scene=21#wechat_redirect" style="margin: 0px;padding: 0px;outline: 0px;color: rgb(87, 107, 149);text-decoration: none;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);cursor: pointer;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;" target="_blank" wah-hotarea="click"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 15px;letter-spacing: 2px;">更多详情，点我查看！</span></a></p></section></section></section></section><section data-role="paragraph" style='margin: 0px;padding: 0px;outline: currentcolor none 0px;max-width: 100%;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: 0.544px;orphans: 2;text-indent: 0px;text-transform: none;white-space: normal;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;color: rgb(0, 0, 0);font-size: 16px;text-align: left;font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;background-color: rgb(255, 255, 255);box-sizing: border-box !important;overflow-wrap: break-word !important;'><section data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style='margin: 0px;padding: 0px 10px;outline: currentcolor none 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word;line-height: 1.6;letter-spacing: 0px;word-break: break-word;font-family: Roboto, Oxygen, Ubuntu, Cantarell, PingFangSC-light, PingFangTC-light, "Open Sans", "Helvetica Neue", sans-serif;'><section data-id="94386" data-tools="135编辑器" style="margin: 0px;padding: 0px;outline: currentcolor none 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;letter-spacing: 0.544px;"><section style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;display: flex;justify-content: flex-start;align-items: center;"><section style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;width: 50px;"><section style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;width: 50px;"><img src="/htmlfiles/浅析JWT安全问题/mmbiz_gif/7QRTvkK2qC6iavic0tIJIoZCwKvUYnFFiaibgSm6mrFp1ZjAg4ITRicicuLN88YodIuqtF4DcUs9sruBa0bFLtX59lQQ/640"/></section></section><section style="margin: 0px 0px 0px 10px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;display: inline-block;"><section data-brushtype="text" style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;font-size: 14px;color: rgb(63, 63, 63);letter-spacing: 2px;"><span style="margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;letter-spacing: 1px;">靶场实操，戳</span><span style="margin: 0px;padding: 0px;outline: currentcolor none 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;letter-spacing: 1px;color: rgb(255, 76, 65);">“阅读原文</span></section></section></section></section></section></section></div>
</div>
<div class="article-tag__error-tips" id="js_tags_preview_toast" style="display: none;">预览时标签不可点</div>
<div id="content_bottom_area"><!-- --><!-- --><!-- --><div class="article-tag__list" data-len="1"><div class="article-tags"><div class="article-tag__item-wrp js_tag weui-wa-hotarea js_wx_tap_highlight wx_tap_link" data-album_id="1350987777487454210" data-tag_id="0" data-tag_source="0" data-url="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MjM5MTYxNjQxOA==&amp;action=getalbum&amp;album_id=1350987777487454210#wechat_redirect" role="link" tabindex="0"><span class="article-tag__item"><i class="weui-icon-album"></i>经验总结</span><span class="article-tag__item-num"><span id="">62</span></span></div></div></div><div class="appmsg_card_context album_read_card" style=""><div class="album_read_hd weui-flex" role="button"><div class="album_read_source"><span class="wx_tap_link js_album_directory__name">经验总结 · 目录</span><i class="weui-icon-read"></i></div></div><div class="album_read_bd weui-flex"><span class="album_read_nav_item album_read_nav_prev weui-flex__item wx_tap_link js_wx_tap_highlight" role="button"><span class="album_read_nav_inner"><span class="album_read_nav_btn">上一篇</span><span class="album_read_nav_title"><span class="album_read_nav_title_inner">深入浅出Flask PIN</span></span></span></span><span class="album_read_nav_item album_read_nav_next weui-flex__item wx_tap_link js_wx_tap_highlight" role="button"><span class="album_read_nav_inner"><span class="album_read_nav_btn">下一篇</span><span class="album_read_nav_title"><span class="album_read_nav_title_inner">OAuth2-0协议安全学习</span></span></span></span></div></div><div class="rich_media_tool_area"><div class="rich_media_tool__wrp"><div class="rich_media_tool" id="js_content_end"><div class="rich_media_info weui-flex policy_tips tips_global_primary"><!-- --></div><div class="rich_media_info weui-flex"><a class="media_tool_meta meta_primary js_wx_tap_highlight wx_tap_link" id="js_view_source">阅读原文</a><!-- --><!-- --></div><div class="weui-flex sns_opr_area" id="js_bottom_opr_right" style="display: none;"><!-- --></div></div><!-- --></div></div></div>
</div>
</div>
<div class="rich_media_area_primary sougou" id="sg_tj" style="display:none"></div>
<div class="rich_media_area_extra">
<div class="rich_media_area_extra_inner">
<div id="page_bottom_area"><div aria-hidden="true" style="font-size: 0px; height: 0px;">​</div><!-- --><div class="related_container"><div class="relate_mod_transition function_mod js_related_area" style="overflow: visible; opacity: 1; height: calc(18em + 58.8906px); margin: 8px 0px 0px; transition: none 0s ease 0s;"><div class="function_mod_index js_related_main"><div class="function_hd js_related_title">喜欢此内容的人还喜欢</div><div class="function_bd"><div class="relate_article_index_list relate_article_list js_related_list" style="height: auto;"><div class="weui-media-box weui-media-box_appmsg js_related_item js_wx_tap_highlight wx_tap_cell" data-bizuin="2391616418" data-exptype="timeline_recommend_article_extendread_samebiz" data-ext_info='{"rec_info":{"model_id":20050,"rank_rk":"20010#20050:24720:0:100:1","recall_rk":"11008:2:0","prerank_rk":"20010#20050:24720:0:0:1","rec_reason":{},"related_score":76167,"prerank_extra":"20010_preds:13366#20010_rule_bizqualitygrading:2#20010_rule_article_quality_grading_v2:1#20050_preds:76167","rank_extra":"20010_preds:13366#20010_rule_bizqualitygrading:2#20010_rule_article_quality_grading_v2:1#20050_preds:76167"},"do_not_report":0}' data-idx="1" data-index="0" data-isreaded="0" data-item_show_type="0" data-mid="2652903744" data-recalltype="11008" data-report_info="{}" data-time="1706869800" data-url="http://mp.weixin.qq.com/s?__biz=MjM5MTYxNjQxOA==&amp;mid=2652903744&amp;idx=1&amp;sn=6ed2aa915aa2abaf0263eca0ccdde5da&amp;chksm=bcdd955a853fa64cc49a8a2b5f6fe92759b15ba540aeead051554ff83a149ae8f96b69452a50&amp;scene=132&amp;exptype=timeline_recommend_article_extendread_samebiz#wechat_redirect"><div class="weui-media-box__bd"><div aria-labelledby="relate_article_title_2652903744_1 js_a11y_comma relate_article_tag_2652903744 js_a11y_comma relate_article_nickname_2652903744_1 js_a11y_comma relate_article_num_2652903744_1" class="ellipsis_relate_title mask_ellipsis_wrp mask_ellipsis_auto_height relate_article_default" role="link" tabindex="0"><div aria-hidden="true" class="mask_ellipsis_text"> 第一波红包封面来啦，手慢无 <!-- --></div><div aria-hidden="true" class="mask_ellipsis"><div class="mask_ellipsis_text" id="relate_article_title_2652903744_1"> 第一波红包封面来啦，手慢无 <!-- --></div><div class="mask_ellipsis_placeholder"></div><div class="mask_ellipsis_extra">   <!-- --></div></div></div><div class="weui-media-box__info weui-flex"><div class="weui-media-box__info__inner weui-flex weui-flex_align-center weui-flex__item"><!-- --><div aria-hidden="true" class="js_profile relate_profile_nickname weui-media-box__info__meta" data-username="gh_3b9faa7969d6" id="relate_article_nickname_2652903744_1"> 合天网安实验室 </div><div aria-hidden="true" class="weui-media-box__info__meta" id="relate_article_num_2652903744_1"><!-- --></div></div><div class="relate_article_opr"><button class="reset_btn dislike_btn js_feedback_btn weui-wa-hotarea" type="button">不喜欢</button></div><div aria-hidden="true" aria-modal="true" class="feedback_dialog_wrp js_feedback_dialog" role="dialog" tabindex="0"><div aria-label="关闭" class="weui-mask js_mask" role="button"></div><div class="feedback_dialog js_dialog_wrp"><div class="feedback_dialog_hd weui-flex"><div class="weui-flex__item feedback_dialog_title">不看的原因</div><button class="weui-btn weui-btn_primary weui-btn_mini js_submit weui-btn_disabled" type="button">确定</button></div><div class="feedback_dialog_bd"><ul class="feedback_tag_list"><li class="feedback_tag_item js_reason js_tag_item" data-value="1" role="checkbox">内容质量低</li><li class="feedback_tag_item js_reason js_tag_item" data-value="2" role="checkbox">不看此公众号</li></ul></div></div></div></div></div><div class="weui-media-box__ft"><img src="/htmlfiles/浅析JWT安全问题/mmbiz_jpg/3RhuVysG9LeFvUnkibUm83Mk5JmsBm5MNW0mP914HXRolfIynAALt7aKlS88dRmCicAUx56dEw0tc0DOVzeS0J5Q/0"/></div></div><div class="weui-media-box weui-media-box_appmsg js_related_item js_wx_tap_highlight wx_tap_cell" data-bizuin="2391616418" data-exptype="timeline_recommend_article_extendread_samebiz" data-ext_info='{"rec_info":{"model_id":20050,"rank_rk":"20010#20050:22939:0:100:2","recall_rk":"11008:1:0","prerank_rk":"20010#20050:22939:0:0:2","rec_reason":{},"related_score":72458,"prerank_extra":"20010_preds:12403#20010_rule_bizqualitygrading:2#20010_rule_article_quality_grading_v2:1#20050_preds:72458","rank_extra":"20010_preds:12403#20010_rule_bizqualitygrading:2#20010_rule_article_quality_grading_v2:1#20050_preds:72458"},"do_not_report":0}' data-idx="1" data-index="1" data-isreaded="0" data-item_show_type="0" data-mid="2652903758" data-recalltype="11008" data-report_info="{}" data-time="1707036300" data-url="http://mp.weixin.qq.com/s?__biz=MjM5MTYxNjQxOA==&amp;mid=2652903758&amp;idx=1&amp;sn=6853f0d0006acdf21a705aa95d41524f&amp;chksm=bc973b9c94730c05ff46b5cdb383bf02380a5ce5d522b39b05cd670a94abd6a56130cd085dde&amp;scene=132&amp;exptype=timeline_recommend_article_extendread_samebiz#wechat_redirect"><div class="weui-media-box__bd"><div aria-labelledby="relate_article_title_2652903758_1 js_a11y_comma relate_article_tag_2652903758 js_a11y_comma relate_article_nickname_2652903758_1 js_a11y_comma relate_article_num_2652903758_1" class="ellipsis_relate_title mask_ellipsis_wrp mask_ellipsis_auto_height relate_article_default" role="link" tabindex="0"><div aria-hidden="true" class="mask_ellipsis_text"> 第二波红包封面来啦，手慢无 <!-- --></div><div aria-hidden="true" class="mask_ellipsis"><div class="mask_ellipsis_text" id="relate_article_title_2652903758_1"> 第二波红包封面来啦，手慢无 <!-- --></div><div class="mask_ellipsis_placeholder"></div><div class="mask_ellipsis_extra">   <!-- --></div></div></div><div class="weui-media-box__info weui-flex"><div class="weui-media-box__info__inner weui-flex weui-flex_align-center weui-flex__item"><!-- --><div aria-hidden="true" class="js_profile relate_profile_nickname weui-media-box__info__meta" data-username="gh_3b9faa7969d6" id="relate_article_nickname_2652903758_1"> 合天网安实验室 </div><div aria-hidden="true" class="weui-media-box__info__meta" id="relate_article_num_2652903758_1"><!-- --></div></div><div class="relate_article_opr"><button class="reset_btn dislike_btn js_feedback_btn weui-wa-hotarea" type="button">不喜欢</button></div><div aria-hidden="true" aria-modal="true" class="feedback_dialog_wrp js_feedback_dialog" role="dialog" tabindex="0"><div aria-label="关闭" class="weui-mask js_mask" role="button"></div><div class="feedback_dialog js_dialog_wrp"><div class="feedback_dialog_hd weui-flex"><div class="weui-flex__item feedback_dialog_title">不看的原因</div><button class="weui-btn weui-btn_primary weui-btn_mini js_submit weui-btn_disabled" type="button">确定</button></div><div class="feedback_dialog_bd"><ul class="feedback_tag_list"><li class="feedback_tag_item js_reason js_tag_item" data-value="1" role="checkbox">内容质量低</li><li class="feedback_tag_item js_reason js_tag_item" data-value="2" role="checkbox">不看此公众号</li></ul></div></div></div></div></div><div class="weui-media-box__ft"><img src="/htmlfiles/浅析JWT安全问题/mmbiz_jpg/3RhuVysG9LeLMhUDErqsuJ5SjjYMVDXYWBzORxrgY3rLcxBRTAJ3EyXkEN0dEh8aMwLTu8x4uzZsfVBVqMMRJw/0"/></div></div><div class="weui-media-box weui-media-box_appmsg js_related_item js_wx_tap_highlight wx_tap_cell" data-bizuin="2391616418" data-exptype="timeline_recommend_article_extendread_samebiz" data-ext_info='{"rec_info":{"model_id":20050,"rank_rk":"20010#20050:21124:0:100:3","recall_rk":"11008:9:0","prerank_rk":"20010#20050:21124:0:0:3","rec_reason":{},"related_score":73684,"prerank_extra":"20010_preds:11433#20010_rule_bizqualitygrading:2#20010_rule_article_quality_grading_v2:0#20050_preds:73684","rank_extra":"20010_preds:11433#20010_rule_bizqualitygrading:2#20010_rule_article_quality_grading_v2:0#20050_preds:73684"},"do_not_report":0}' data-idx="2" data-index="2" data-isreaded="0" data-item_show_type="0" data-mid="2652903537" data-recalltype="11008" data-report_info="{}" data-time="1706002440" data-url="http://mp.weixin.qq.com/s?__biz=MjM5MTYxNjQxOA==&amp;mid=2652903537&amp;idx=2&amp;sn=02b61e4d24645fa537bb7377d166070a&amp;chksm=bc3d586e92224675f2978ccef76aed5726fff349c1b26bb3cf3a90813504687bc2a154610391&amp;scene=132&amp;exptype=timeline_recommend_article_extendread_samebiz#wechat_redirect"><div class="weui-media-box__bd"><div aria-labelledby="relate_article_title_2652903537_2 js_a11y_comma relate_article_tag_2652903537 js_a11y_comma relate_article_nickname_2652903537_2 js_a11y_comma relate_article_num_2652903537_2" class="ellipsis_relate_title mask_ellipsis_wrp mask_ellipsis_auto_height relate_article_default" role="link" tabindex="0"><div aria-hidden="true" class="mask_ellipsis_text"> 玩转渗透，如此简单 <!-- --></div><div aria-hidden="true" class="mask_ellipsis"><div class="mask_ellipsis_text" id="relate_article_title_2652903537_2"> 玩转渗透，如此简单 <!-- --></div><div class="mask_ellipsis_placeholder"></div><div class="mask_ellipsis_extra">   <!-- --></div></div></div><div class="weui-media-box__info weui-flex"><div class="weui-media-box__info__inner weui-flex weui-flex_align-center weui-flex__item"><!-- --><div aria-hidden="true" class="js_profile relate_profile_nickname weui-media-box__info__meta" data-username="gh_3b9faa7969d6" id="relate_article_nickname_2652903537_2"> 合天网安实验室 </div><div aria-hidden="true" class="weui-media-box__info__meta" id="relate_article_num_2652903537_2"><!-- --></div></div><div class="relate_article_opr"><button class="reset_btn dislike_btn js_feedback_btn weui-wa-hotarea" type="button">不喜欢</button></div><div aria-hidden="true" aria-modal="true" class="feedback_dialog_wrp js_feedback_dialog" role="dialog" tabindex="0"><div aria-label="关闭" class="weui-mask js_mask" role="button"></div><div class="feedback_dialog js_dialog_wrp"><div class="feedback_dialog_hd weui-flex"><div class="weui-flex__item feedback_dialog_title">不看的原因</div><button class="weui-btn weui-btn_primary weui-btn_mini js_submit weui-btn_disabled" type="button">确定</button></div><div class="feedback_dialog_bd"><ul class="feedback_tag_list"><li class="feedback_tag_item js_reason js_tag_item" data-value="1" role="checkbox">内容质量低</li><li class="feedback_tag_item js_reason js_tag_item" data-value="2" role="checkbox">不看此公众号</li></ul></div></div></div></div></div><div class="weui-media-box__ft"><img src="/htmlfiles/浅析JWT安全问题/mmbiz_jpg/3RhuVysG9LdJLBAC7tcziaibdibNuLD6Qh6t4ZbhHDZknTcOrzXxRZx4sR55EXicgNzOUXvVrEH7EI6y2K2jBkxgNg/0"/></div></div></div></div></div></div></div><div class="mpda_bottom_container"><!-- --></div><!-- --><div class="rich_media_extra rich_media_extra_discuss rich_media_extra_discuss_empty" data-v-0a0c020c="" id="js_cmt_container" style="display: none;"><div aria-hidden="true" aria-modal="true" data-v-0a0c020c="" role="dialog" style="visibility: hidden;" tabindex="0"><div class="discuss_form_write_area" data-v-0a0c020c=""><div class="discuss_form_write_mod" data-v-0a0c020c="" data-v-ab884c67=""><div class="rich_media_extra_title_wrp weui-flex" data-v-ab884c67=""><div class="weui-flex__item" data-v-ab884c67=""><div class="comment_input_profile" data-v-ab884c67="" role="button" title="轻点两下切换身份"><span class="comment_input_profile_avatar" data-v-ab884c67=""></span><strong class="comment_input_profile_nickname" data-v-ab884c67=""></strong><!-- --><span class="weui-btn_plate weui-btn_plate-circle comment_input_transfer_btn" data-v-ab884c67=""><i class="weui-icon-medium-transfer" data-v-ab884c67=""></i></span></div></div><a class="weui-wa-hotarea js_wx_tap_highlight wx_tap_link" data-v-ab884c67="" role="button">取消 </a></div><div class="discuss_form_write_input_wrp" data-v-ab884c67=""><textarea class="discuss_form_write_input" data-v-ab884c67="" placeholder="留言精选后，将对所有人可见并外显IP归属地"></textarea><textarea aria-hidden="true" class="discuss_form_write_input" data-v-ab884c67="" placeholder="留言精选后，将对所有人可见并外显IP归属地" readonly="readonly" style="display: none;"></textarea></div><div data-v-ab884c67=""><div class="discuss_form_write_tool weui-flex" data-v-ab884c67=""><div class="weui-flex__item" data-v-ab884c67=""><span class="discuss_form_write_tips" data-v-ab884c67=""></span></div><a aria-label="表情" class="icon_discuss_emotion" data-v-ab884c67="" role="button" title="轻点两下打开表情键盘"></a><button class="weui-btn weui-btn_primary weui-btn_xmini weui-wa-hotarea discuss_form_write_btn weui-btn_disabled" data-v-ab884c67="" disabled="disabled" title="不可点击" type="button"> 留言 </button></div></div></div></div><div class="discuss_form_write_mask weui-mask_transparent" data-v-0a0c020c="" style="display: none;"></div></div><div data-v-0a0c020c=""><!-- --><div class="discuss_mod" data-v-0a0c020c="" id="js_cmt_area" style="display: none;"><div class="discuss_container my_discuss_container" data-v-0a0c020c="" style="display: none;"><div class="rich_media_extra_title_wrp weui-flex" data-v-0a0c020c="" style=""><div class="weui-flex__item" data-v-0a0c020c=""><strong aria-level="2" class="rich_media_extra_title" data-v-0a0c020c="" role="heading">我的留言</strong></div><p class="tips_global" data-v-0a0c020c="" style="display: none;"></p><a class="weui-wa-hotarea js_wx_tap_highlight wx_tap_link" data-v-0a0c020c="" role="button" style="display: none;">写留言</a></div><div class="discuss_list_wrp" data-v-0a0c020c="" style=""><div data-v-0a0c020c="" data-v-e0e220c8=""><ul class="discuss_list" data-v-e0e220c8="" role="none"></ul></div></div><div class="weui-loadmore weui-loadmore_default" data-v-0a0c020c="" role="alert" style="display: none;"><i class="weui-loading" data-v-0a0c020c=""></i></div><div class="weui-fold-tips weui-wa-hotarea_before" data-v-0a0c020c="" style="display: none;">展开我的留言</div> <div class="my_dicuss_list_end_tips weui-loadmore weui-loadmore_default weui-loadmore_line" data-v-0a0c020c="" style="display: none;"><span class="weui-loadmore__tips" data-v-0a0c020c=""> 留言被精选后将公开 </span></div></div><div class="discuss_container star_discuss_container" data-v-0a0c020c="" style="display: none;"><div class="rich_media_extra_title_wrp weui-flex" data-v-0a0c020c=""><div class="weui-flex__item" data-v-0a0c020c=""><strong aria-level="2" class="rich_media_extra_title" data-v-0a0c020c="" role="heading">0条留言</strong></div><p class="tips_global" data-v-0a0c020c="" style="display: none;"></p><a class="weui-wa-hotarea js_wx_tap_highlight wx_tap_link" data-v-0a0c020c="" role="button" style="display: none;">写留言</a></div><div class="discuss_list_wrp" data-v-0a0c020c=""><div data-v-0a0c020c="" data-v-e0e220c8="" show-all="true"><ul class="discuss_list" data-v-e0e220c8="" role="none"></ul></div></div></div><div class="discuss_container discuss_data_empty" data-v-0a0c020c="" style="display: none;"><div class="rich_media_extra_title_wrp tc" data-v-0a0c020c=""><div class="tips_global" data-v-0a0c020c="" style="display: none;"></div><a class="weui-wa-hotarea js_wx_tap_highlight wx_tap_link" data-v-0a0c020c="" role="button" style="display: none;">写留言</a></div></div><div class="discuss_container discuss_container_loading" data-v-0a0c020c="" role="option" style="display: none;"><div class="weui-loadmore weui-loadmore_default" data-v-0a0c020c=""><span class="weui-primary-loading" data-v-0a0c020c=""><i class="weui-primary-loading__dot" data-v-0a0c020c=""></i></span></div></div><div class="weui-fold-tips weui-wa-hotarea_before" data-v-0a0c020c="" style="display: none;">全部留言</div> <div class="weui-loadmore weui-loadmore_default weui-loadmore_line weui-loadmore_dot" data-v-0a0c020c="" role="option" style="display: none;"><div class="weui-hidden_abs" data-v-0a0c020c="">已无更多数据</div><span class="weui-loadmore__tips" data-v-0a0c020c=""></span></div><div class="discuss_warn_toast weui-toast__wrp" data-v-0a0c020c="" role="alert" style="display: none;"><div class="weui-mask_transparent" data-v-0a0c020c=""></div><div class="weui-toast weui-toast_text-more" data-v-0a0c020c=""><i class="weui-icon-warn weui-icon_toast" data-v-0a0c020c=""></i><p class="weui-toast__content js_content" data-v-0a0c020c=""> </p></div></div></div><div class="discuss_mod" data-v-0a0c020c="" id="js_msg_area" style="display: none;"><div class="discuss_container discuss_data_empty" data-v-0a0c020c="" style="display: none;"><div class="rich_media_extra_title_wrp tc" data-v-0a0c020c=""><div class="tips_global" data-v-0a0c020c="" style="display: none;"></div><a class="weui-wa-hotarea js_wx_tap_highlight wx_tap_link" data-v-0a0c020c="" role="button" style="display: none;">发消息</a></div></div></div><div class="discuss_bottom_form" data-v-0a0c020c="" style="display: none;"><div class="discuss_bottom_form_inner weui-flex" data-v-0a0c020c=""><div class="discuss_form_avatar_wrp" data-v-0a0c020c="" role="button" title="轻点两下切换身份"><span aria-label="" class="discuss_form_avatar" data-v-0a0c020c="" role="img"></span><span class="weui-btn_plate weui-btn_plate-circle discuss_form_transfer_btn" data-v-0a0c020c=""><i class="weui-icon-medium-transfer" data-v-0a0c020c=""></i></span></div><div class="weui-flex__item" data-v-0a0c020c=""><div class="discuss_form_input" data-v-0a0c020c="" role="option">留言精选后，将对所有人可见并外显IP归属地</div></div><a aria-label="表情" class="icon_discuss_emotion" data-v-0a0c020c="" role="button" title="轻点两下打开表情键盘"></a></div></div><div aria-hidden="true" aria-modal="true" class="wx_bottom_modal_wrp discuss_write_dialog_wrp" data-v-0a0c020c="" role="dialog" style="visibility: hidden;" tabindex="0"><div class="weui-half-screen-dialog wx_bottom_modal" style="max-height: none;"><div class="weui-half-screen-dialog__hd__wrp"><div class="weui-half-screen-dialog__hd"><div class="weui-half-screen-dialog__hd__side"><button class="weui-btn_icon weui-wa-hotarea">关闭<i class="weui-icon-half-screen-close"></i></button></div><div class="weui-half-screen-dialog__hd__main"><strong class="weui-half-screen-dialog__title">写留言</strong></div><div class="weui-half-screen-dialog__hd__side"><button class="weui-btn_disabled weui-btn weui-btn_primary weui-btn_mini">提交</button><button class="weui-btn_icon weui-wa-hotarea" style="display: none;">更多<i class="weui-icon-more"></i></button></div></div></div><div class="weui-half-screen-dialog__bd"><div class="weui-loadmore" style="display: none;"><i class="weui-loading"></i></div><div class="wx_bottom_modal_msg_wrp" style="display: none;"><div class="wx_bottom_modal_msg"><i class="weui-loading"></i></div></div><div class="weui-loadmore weui-loadmore_line weui-loadmore_dot" style="display: none;"><span class="weui-loadmore__tips"></span></div><div class="comment_reply_context_wrp"><div class="comment_reply_context"><!-- --><textarea class="weui-textarea comment_textarea" placeholder="留言精选后，将对所有人可见并外显IP归属地"></textarea><textarea aria-hidden="true" class="weui-textarea comment_textarea" placeholder="留言精选后，将对所有人可见并外显IP归属地" readonly="readonly" style="flex: 1 1 0%; display: none;"></textarea><div class="discuss_toolbar"><a class="icon_discuss_emotion" role="button">表情</a><span class="comment_write_counter"></span></div></div></div><div class="weui-loadmore" style="display: none;"><i class="weui-loading"></i></div></div><!-- --></div><div class="wx_bottom_modal_mask_fixed"></div><div class="weui-mask wx_bottom_modal_mask" style="opacity: 1;"></div></div><div aria-modal="true" class="discuss_more_pc_dialog_wrp" data-v-0a0c020c="" reply-title="留言" role="dialog" style="display: none;" tabindex="0"><div class="discuss_more_pc_dialog"><div class="discuss_more_pc_dialog_hd"><strong class="discuss_more_pc_dialog_title">留言</strong><button class="discuss_more_pc_dialog_close_btn reset_btn"><i class="weui-icon-close"></i></button></div><div class="discuss_more_pc_dialog_bd"><!-- --></div></div><div class="weui-mask"></div></div><!-- --></div></div><!-- --></div>
</div>
</div>
<div class="qr_code_pc_outer" id="js_pc_qr_code" style="display: block;">
<div class="qr_code_pc_inner">
<div class="qr_code_pc">
<img src="/htmlfiles/浅析JWT安全问题/mp/qrcode"/>
<p>微信扫一扫<br/>关注该公众号</p>
</div>
</div>
</div>
</div>
<div class="wx_stream_article_slide_tip" id="wx_stream_article_slide_tip">
<div class="wx_stream_article_slide_tip_wrp">
<span class="wx_stream_article_slide_tip_arrow"></span>
<span class="wx_stream_article_slide_tip_text">继续滑动看下一个</span>
</div>
</div>
</div>
<div class="wx_network_msg_wrp" id="js_network_msg_wrp"></div>
<div class="wx_expand_article" id="wx_expand_article">
<div class="stream_mock_header" id="stream_mock_header">
<h1 class="rich_media_title">浅析JWT安全问题</h1>
<div class="rich_media_meta_list" id="meta_content">
<span class="wx_tap_link js_wx_tap_highlight rich_media_meta icon_appmsg_tag appmsg_title_tag weui-wa-hotarea" id="copyright_logo">原创</span>
<span class="rich_media_meta rich_media_meta_text">
                                  BlackWatch
                              </span>
<span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
<a class="wx_tap_link js_wx_tap_highlight weui-wa-hotarea" id="js_name">
            合天网安实验室          </a>
</span>
</div>
</div>
<div class="wx_expand_article_gradient_background" id="wx_expand_background"></div>
<div class="wx_expand_article_bottom_area" id="wx_expand_bottom">
<div class="wx_expand_article_button_wrap" id="wx_expand_article_placeholder">
<button class="wx_expand_article_button" id="wx_expand_article_button">轻触阅读原文</button>
</div>
<div class="stream_bottom_bar_wrp" id="js_stream_bottom_bar">
<div class="bottom_bar_placeholder" id="js_stream_bottom_bar_placeholder">
<div class="wx_follow_context wx_follow_primary wx_follow_smart wx_follow_top wx_follow_bottom">
<div class="function_mod js_function_mod wx_tap_cell">
<div class="function_mod_inner js_function_mod_inner">
<div class="function_bd">
<div class="wx_follow_media weui-flex weui-flex_align-center">
<div class="wx_follow_hd">
<span class="wx_follow_avatar">
<img src="/htmlfiles/浅析JWT安全问题/mmbiz_png/3RhuVysG9LdiaF9MPibRx6nCnmfKhr6FicJn2Jrsiat4GaeTAvS27lSFPJ2hAwCB2WE6kicrJb0ibZYjlbaxUluT5ZWQ/0"/>
</span>
</div>
<div class="wx_follow_bd weui-flex__item">
<div class="wx_follow_info">
<div aria-describedby="js_wx_follow_tips" aria-labelledby="js_wx_follow_nickname" class="wx_follow_nickname js_wx_tap_highlight wx_tap_link" role="link" tabindex="0">
                        合天网安实验室                      </div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="interaction_bar__wrap" style="opacity: 1;">
<div class="interaction_bar" style="-webkit-text-size-adjust: 100%;">
<button aria-labelledby="js_a11y_zan_btn_txt likeNum_old" class="sns_opr_btn sns_praise_btn weui-wa-hotarea js_wx_tap_highlight wx_tap_link">
<span aria-hidden="true" class="sns_opr_gap">赞</span>
</button>
<button aria-labelledby="js_a11y_share_btn_txt" class="sns_opr_btn sns_share_btn weui-wa-hotarea js_wx_tap_highlight wx_tap_link">
<span aria-hidden="true" class="sns_opr_gap">分享</span>
</button>
<button aria-labelledby="js_a11y_like_btn_txt likeNum3" class="sns_opr_btn sns_like_btn weui-wa-hotarea js_wx_tap_highlight wx_tap_link">
<span aria-hidden="true" class="sns_opr_gap">在看</span>
</button>
<button aria-labelledby="js_a11y_comment_btn_txt" class="sns_opr_btn sns_sc_comment_btn weui-wa-hotarea js_wx_tap_highlight wx_tap_link sns_write_comment_btn">
<span aria-hidden="true" class="sns_opr_gap">写留言</span>
</button>
</div>
</div>
</div>
<div id="stream_article_bottom_area"></div>
</div>
</div>
<div class="wx_expand_article_slide_tip" id="wx_expand_slidetip">
<div class="wx_stream_article_slide_tip">
<div class="wx_stream_article_slide_tip_wrp">
<span class="wx_stream_article_slide_tip_arrow"></span>
<span class="wx_stream_article_slide_tip_text">向上滑动看下一个</span>
</div>
</div>
</div>
</div>
<div class="wx_network_msg_wrp" id="js_network_msg_wrp"></div>
<div aria-hidden="true" aria-modal="true" class="wx_bottom_modal_wrp" data-v-f8e61417="" role="dialog" style="visibility: hidden;" tabindex="0"><div class="weui-half-screen-dialog wx_bottom_modal" style="max-height: 450px;"><!-- --><div class="weui-half-screen-dialog__bd"><div class="weui-loadmore" style="display: none;"><i class="weui-loading"></i></div><div class="wx_bottom_modal_msg_wrp" style="display: none;"><div class="wx_bottom_modal_msg"><i class="weui-loading"></i></div></div><div class="weui-loadmore weui-loadmore_line weui-loadmore_dot" style="display: none;"><span class="weui-loadmore__tips"></span></div><div class=""><p class="ad_control-tips" data-v-f8e61417="">当前内容可能存在未经审核的第三方商业营销信息，请确认是否继续访问。</p></div><div class="weui-loadmore" style="display: none;"><i class="weui-loading"></i></div></div><div class="weui-half-screen-dialog__ft"><div class="weui-half-screen-dialog__btn-area" data-v-f8e61417=""><a class="weui-btn weui-btn_default" data-v-f8e61417="" wah-hotarea="click">继续访问</a><a class="weui-btn weui-btn_primary" data-v-f8e61417="" wah-hotarea="click">取消</a></div><div class="weui-half-screen-dialog__attachment-area" data-v-f8e61417=""><a class="weui-link" data-v-f8e61417="" href="javacript:;">微信公众平台广告规范指引</a></div></div></div><div class="wx_bottom_modal_mask_fixed"></div><div class="weui-mask wx_bottom_modal_mask" style="opacity: 1;"></div></div>
<div class="comment_primary_emotion_panel_wrp" id="js_emotion_panel_pc" style="display: none">
<div class="comment_primary_emotion_panel">
<ul class="comment_primary_emotion_list_pc" id="js_emotion_list_pc">
</ul>
</div>
</div>
<div class="weui-dialog__wrp" id="js_alert_panel" style="display:none;">
<div class="weui-mask"></div>
<div class="weui-dialog">
<div class="weui-dialog__bd" id="js_alert_content"></div>
<div class="weui-dialog__ft">
<a class="weui-dialog__btn weui-dialog__btn_default" id="js_alert_confirm">知道了</a>
</div>
</div>
</div>
<div class="weui-desktop-popover weui-desktop-popover_pos-up-center weui-desktop-popover_img-text weapp_code_popover" id="js_pc_weapp_code" style="display: none;">
<div class="weui-desktop-popover__inner">
<div class="weui-desktop-popover__desc">
<img id="js_pc_weapp_code_img"/>
          微信扫一扫<br/>使用小程序<span id="js_pc_weapp_code_des"></span>
</div>
</div>
</div>
<div aria-labelledby="js_minipro_dialog_head" aria-modal="true" id="js_minipro_dialog" role="dialog" style="display:none;" tabindex="0">
<div class="weui-mask"></div>
<div class="weui-dialog weui-dialog_link">
<div class="weui-dialog__hd">
<strong class="weui-dialog__title" id="js_minipro_dialog_head" tabindex="0"></strong>
</div>
<div class="weui-dialog__bd" id="js_minipro_dialog_body"></div>
<div class="weui-dialog__ft">
<a class="weui-dialog__btn weui-dialog__btn_default" id="js_minipro_dialog_cancel" role="button">取消</a>
<a class="weui-dialog__btn weui-dialog__btn_primary" id="js_minipro_dialog_ok" role="button">允许</a>
</div>
</div>
</div>
<div aria-labelledby="js_link_dialog_body" aria-modal="true" id="js_link_dialog" role="dialog" style="display:none;" tabindex="0">
<div class="weui-mask"></div>
<div class="weui-dialog weui-dialog_link">
<div class="weui-dialog__hd">
<strong class="weui-dialog__title" id="js_link_dialog_head" tabindex="0"></strong>
</div>
<div class="weui-dialog__bd" id="js_link_dialog_body" tabindex="0"></div>
<div class="weui-dialog__ft">
<a class="weui-dialog__btn weui-dialog__btn_default" id="js_link_dialog_cancel" role="button">取消</a>
<a class="weui-dialog__btn weui-dialog__btn_primary" id="js_link_dialog_ok" role="button">允许</a>
</div>
</div>
</div>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_colon" style="display:none">：</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_comma" style="display:none">，</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_period" style="display:none">。</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_space" style="display:none"> </span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_type_video" style="display:none">视频</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_type_weapp" style="display:none">小程序</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_zan_btn_txt" style="display:none">赞</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_zan_btn_tips" style="display:none">，轻点两下取消赞</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_like_btn_txt" style="display:none">在看</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_like_btn_tips" style="display:none">，轻点两下取消在看</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_share_btn_txt" style="display:none">分享</span>
<span aria-hidden="true" class="weui-a11y_ref" id="js_a11y_comment_btn_txt" style="display:none">留言</span>
<div class="wx-root" data-weui-theme="light"></div><div class="wx-root" data-weui-theme="dark"></div><div><span class=""><span></span><div aria-modal="true" class="weui-pc-popover__wrp wx_user_profile_dialog_pc" role="dialog" tabindex="0"><div class="weui-pc-popover weui-pc-popover_radius-tail weui-pc-popover_pos-right weui-pc-popover_align-center"><!-- --><div class="weui-pc-popover__bd"><div><div class="wx_user_profile weui-flex"><div class="wx_user_profile_hd"><span class="wx_user_profile_avatar wx_border_avatar_origin"></span></div><div class="wx_user_profile_bd"><div class="wx_user_profile_nickname_wrp" role="option"><span class="wx_user_profile_nickname"></span><span class="weui-hidden_abs">,</span><!-- --><!-- --></div><!-- --><!-- --></div></div><div class="wx_user_profile_loading_wrp" style="display: none;"><i class="weui-loading"></i></div></div></div><div class="weui-pc-popover__tail weui-pc-popover__tail_pos-left"></div></div><div class="weui-mask_transparent" style="display: none;"></div></div></span><span class="" data-v-4514c444=""><span></span><div aria-modal="true" class="weui-pc-popover__wrp wx_identity_dialog_pc" role="dialog" tabindex="0"><div class="weui-pc-popover weui-pc-popover_radius-tail weui-pc-popover_pos-right weui-pc-popover_align-center"><div class="weui-pc-popover__hd"><div class="weui-pc-popover__title"><span data-v-4514c444="">选择留言身份</span></div></div><div class="weui-pc-popover__bd"><div class="weui-cells__group weui-cells__group_form wx_identity_group" data-v-4514c444=""><div class="weui-cells weui-cells_radio"><div></div><!-- --></div><!-- --></div><!-- --></div><div class="weui-pc-popover__tail weui-pc-popover__tail_pos-left"></div></div><div class="weui-mask_transparent" style="display: none;"></div></div></span></div><div class="underline-container" data-v-2f929137=""><!-- --><div data-v-2f929137="" data-v-e9735b1d="" style="position: absolute; top: 0px; left: 0px; right: 0px;"><div class="underline_share_context" data-v-e9735b1d="" style="width: 100vw; display: none;"><div class="underline_share_bd" data-v-e9735b1d=""><!-- --><div data-v-e9735b1d="" style="white-space: pre-line; position: relative;"></div><div class="underline_share_pre_mask" data-v-e9735b1d="" style="height: 0px;"></div><div class="underline_share_next_mask" data-v-e9735b1d="" style="height: 0px;"></div></div><div class="underline_share_ft" data-v-e9735b1d=""><div class="underline_share_ft_line" data-v-e9735b1d=""></div><div class="underline_share_profile" data-v-e9735b1d=""><!-- --><div class="underline_share_profile_meta underline_share_info" data-v-e9735b1d=""><strong class="underline_share_nickname" data-v-e9735b1d="">合天网安实验室</strong><div class="underline_share_profile_meta underline_share_article" data-v-e9735b1d=""> 浅析JWT安全问题 </div></div></div></div></div><!-- --></div><div class="menu_options menu_options_default menu_options_show" data-v-2f929137="" data-v-ba8d1fb3="" style="top: 0px; transform: scale(0); color: rgb(51, 51, 51);"><div class="menu_options_bar" data-v-ba8d1fb3=""><div class="context-menu-wrap" data-v-2f929137="" data-v-ba8d1fb3=""><p class="data-text" data-v-2f929137="" data-v-ba8d1fb3=""> 人划线 </p><!-- --></div></div><div class="menu_options_tail" data-v-ba8d1fb3="" style="color: rgb(51, 51, 51);"></div></div><!-- --></div></body></html>